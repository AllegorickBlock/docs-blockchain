import{_ as s,c as n,o as a,L as p}from"./chunks/framework.vEmsHuDM.js";const m=JSON.parse('{"title":"eosio.token example contract","description":"","frontmatter":{"title":"eosio.token example contract","outline":[0,4]},"headers":[],"relativePath":"examples/eosio.token.md","filePath":"examples/eosio.token.md","lastUpdated":null}'),l={name:"examples/eosio.token.md"},o=p(`<h1 id="token-contract" tabindex="-1">Token Contract <a class="header-anchor" href="#token-contract" aria-label="Permalink to &quot;Token Contract&quot;">​</a></h1><h2 id="src-eosio-token-cpp" tabindex="-1">src/eosio.token.cpp <a class="header-anchor" href="#src-eosio-token-cpp" aria-label="Permalink to &quot;src/eosio.token.cpp&quot;">​</a></h2><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&lt;eosio.token/eosio.token.hpp&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">namespace</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">eosio</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">token</span><span style="color:#E1E4E8;">::</span><span style="color:#B392F0;">create</span><span style="color:#E1E4E8;">( </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">name</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;">   </span><span style="color:#FFAB70;">issuer</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">asset</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;">  </span><span style="color:#FFAB70;">maximum_supply</span><span style="color:#E1E4E8;"> )</span></span>
<span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">require_auth</span><span style="color:#E1E4E8;">( </span><span style="color:#B392F0;">get_self</span><span style="color:#E1E4E8;">() );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">auto</span><span style="color:#E1E4E8;"> sym </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> maximum_supply.symbol;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">check</span><span style="color:#E1E4E8;">( sym.</span><span style="color:#B392F0;">is_valid</span><span style="color:#E1E4E8;">(), </span><span style="color:#9ECBFF;">&quot;invalid symbol name&quot;</span><span style="color:#E1E4E8;"> );</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">check</span><span style="color:#E1E4E8;">( maximum_supply.</span><span style="color:#B392F0;">is_valid</span><span style="color:#E1E4E8;">(), </span><span style="color:#9ECBFF;">&quot;invalid supply&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">check</span><span style="color:#E1E4E8;">( maximum_supply.amount </span><span style="color:#F97583;">&gt;=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;max-supply must not be negative&quot;</span><span style="color:#E1E4E8;">);</span><span style="color:#6A737D;"> // ultra-duncan --- support for unlimitted max supply</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    stats </span><span style="color:#B392F0;">statstable</span><span style="color:#E1E4E8;">( </span><span style="color:#B392F0;">get_self</span><span style="color:#E1E4E8;">(), sym.</span><span style="color:#B392F0;">code</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">raw</span><span style="color:#E1E4E8;">() );</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">auto</span><span style="color:#E1E4E8;"> existing </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> statstable.</span><span style="color:#B392F0;">find</span><span style="color:#E1E4E8;">( sym.</span><span style="color:#B392F0;">code</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">raw</span><span style="color:#E1E4E8;">() );</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">check</span><span style="color:#E1E4E8;">( existing </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> statstable.</span><span style="color:#B392F0;">end</span><span style="color:#E1E4E8;">(), </span><span style="color:#9ECBFF;">&quot;token with symbol already exists&quot;</span><span style="color:#E1E4E8;"> );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    statstable.</span><span style="color:#B392F0;">emplace</span><span style="color:#E1E4E8;">( </span><span style="color:#B392F0;">get_self</span><span style="color:#E1E4E8;">(), [</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;">]( </span><span style="color:#F97583;">auto&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">s</span><span style="color:#E1E4E8;"> ) {</span></span>
<span class="line"><span style="color:#E1E4E8;">       s.supply.symbol </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> maximum_supply.symbol;</span></span>
<span class="line"><span style="color:#E1E4E8;">       s.max_supply    </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> maximum_supply;</span></span>
<span class="line"><span style="color:#E1E4E8;">       s.issuer        </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> issuer;</span></span>
<span class="line"><span style="color:#E1E4E8;">    });</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">token</span><span style="color:#E1E4E8;">::</span><span style="color:#B392F0;">issue</span><span style="color:#E1E4E8;">( </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">name</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">to</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">asset</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">quantity</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">string</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">memo</span><span style="color:#E1E4E8;"> )</span></span>
<span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">auto</span><span style="color:#E1E4E8;"> sym </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> quantity.symbol;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">check</span><span style="color:#E1E4E8;">( sym.</span><span style="color:#B392F0;">is_valid</span><span style="color:#E1E4E8;">(), </span><span style="color:#9ECBFF;">&quot;invalid symbol name&quot;</span><span style="color:#E1E4E8;"> );</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">check</span><span style="color:#E1E4E8;">( memo.</span><span style="color:#B392F0;">size</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">&lt;=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">256</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;memo has more than 256 bytes&quot;</span><span style="color:#E1E4E8;"> );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    stats </span><span style="color:#B392F0;">statstable</span><span style="color:#E1E4E8;">( </span><span style="color:#B392F0;">get_self</span><span style="color:#E1E4E8;">(), sym.</span><span style="color:#B392F0;">code</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">raw</span><span style="color:#E1E4E8;">() );</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">auto</span><span style="color:#E1E4E8;"> existing </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> statstable.</span><span style="color:#B392F0;">find</span><span style="color:#E1E4E8;">( sym.</span><span style="color:#B392F0;">code</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">raw</span><span style="color:#E1E4E8;">() );</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">check</span><span style="color:#E1E4E8;">( existing </span><span style="color:#F97583;">!=</span><span style="color:#E1E4E8;"> statstable.</span><span style="color:#B392F0;">end</span><span style="color:#E1E4E8;">(), </span><span style="color:#9ECBFF;">&quot;token with symbol does not exist, create token before issue&quot;</span><span style="color:#E1E4E8;"> );</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">auto&amp;</span><span style="color:#E1E4E8;"> st </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">existing;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">check</span><span style="color:#E1E4E8;">( to </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> st.issuer, </span><span style="color:#9ECBFF;">&quot;tokens can only be issued to issuer account&quot;</span><span style="color:#E1E4E8;"> );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">require_auth</span><span style="color:#E1E4E8;">( st.issuer );</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">check</span><span style="color:#E1E4E8;">( quantity.</span><span style="color:#B392F0;">is_valid</span><span style="color:#E1E4E8;">(), </span><span style="color:#9ECBFF;">&quot;invalid quantity&quot;</span><span style="color:#E1E4E8;"> );</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">check</span><span style="color:#E1E4E8;">( quantity.amount </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;must issue positive quantity&quot;</span><span style="color:#E1E4E8;"> );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">check</span><span style="color:#E1E4E8;">( quantity.symbol </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> st.supply.symbol, </span><span style="color:#9ECBFF;">&quot;symbol precision mismatch&quot;</span><span style="color:#E1E4E8;"> );</span></span>
<span class="line"><span style="color:#6A737D;">    // ultra-duncan --- support for unlimitted max supply</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (st.max_supply.amount </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#B392F0;">check</span><span style="color:#E1E4E8;">( quantity.amount </span><span style="color:#F97583;">&lt;=</span><span style="color:#E1E4E8;"> st.max_supply.amount </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> st.supply.amount, </span><span style="color:#9ECBFF;">&quot;quantity exceeds available supply&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    statstable.</span><span style="color:#B392F0;">modify</span><span style="color:#E1E4E8;">( st, same_payer, [</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;">]( </span><span style="color:#F97583;">auto&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">s</span><span style="color:#E1E4E8;"> ) {</span></span>
<span class="line"><span style="color:#E1E4E8;">       s.supply </span><span style="color:#F97583;">+=</span><span style="color:#E1E4E8;"> quantity;</span></span>
<span class="line"><span style="color:#E1E4E8;">    });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">add_balance</span><span style="color:#E1E4E8;">( st.issuer, quantity );</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">token</span><span style="color:#E1E4E8;">::</span><span style="color:#B392F0;">retire</span><span style="color:#E1E4E8;">( </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">asset</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">quantity</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">string</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">memo</span><span style="color:#E1E4E8;"> )</span></span>
<span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">auto</span><span style="color:#E1E4E8;"> sym </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> quantity.symbol;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">check</span><span style="color:#E1E4E8;">( sym.</span><span style="color:#B392F0;">is_valid</span><span style="color:#E1E4E8;">(), </span><span style="color:#9ECBFF;">&quot;invalid symbol name&quot;</span><span style="color:#E1E4E8;"> );</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">check</span><span style="color:#E1E4E8;">( memo.</span><span style="color:#B392F0;">size</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">&lt;=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">256</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;memo has more than 256 bytes&quot;</span><span style="color:#E1E4E8;"> );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    stats </span><span style="color:#B392F0;">statstable</span><span style="color:#E1E4E8;">( </span><span style="color:#B392F0;">get_self</span><span style="color:#E1E4E8;">(), sym.</span><span style="color:#B392F0;">code</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">raw</span><span style="color:#E1E4E8;">() );</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">auto</span><span style="color:#E1E4E8;"> existing </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> statstable.</span><span style="color:#B392F0;">find</span><span style="color:#E1E4E8;">( sym.</span><span style="color:#B392F0;">code</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">raw</span><span style="color:#E1E4E8;">() );</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">check</span><span style="color:#E1E4E8;">( existing </span><span style="color:#F97583;">!=</span><span style="color:#E1E4E8;"> statstable.</span><span style="color:#B392F0;">end</span><span style="color:#E1E4E8;">(), </span><span style="color:#9ECBFF;">&quot;token with symbol does not exist&quot;</span><span style="color:#E1E4E8;"> );</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">auto&amp;</span><span style="color:#E1E4E8;"> st </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">existing;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">require_auth</span><span style="color:#E1E4E8;">( st.issuer );</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">check</span><span style="color:#E1E4E8;">( quantity.</span><span style="color:#B392F0;">is_valid</span><span style="color:#E1E4E8;">(), </span><span style="color:#9ECBFF;">&quot;invalid quantity&quot;</span><span style="color:#E1E4E8;"> );</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">check</span><span style="color:#E1E4E8;">( quantity.amount </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;must retire positive quantity&quot;</span><span style="color:#E1E4E8;"> );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">check</span><span style="color:#E1E4E8;">( quantity.symbol </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> st.supply.symbol, </span><span style="color:#9ECBFF;">&quot;symbol precision mismatch&quot;</span><span style="color:#E1E4E8;"> );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    statstable.</span><span style="color:#B392F0;">modify</span><span style="color:#E1E4E8;">( st, same_payer, [</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;">]( </span><span style="color:#F97583;">auto&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">s</span><span style="color:#E1E4E8;"> ) {</span></span>
<span class="line"><span style="color:#E1E4E8;">       s.supply </span><span style="color:#F97583;">-=</span><span style="color:#E1E4E8;"> quantity;</span></span>
<span class="line"><span style="color:#E1E4E8;">    });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">sub_balance</span><span style="color:#E1E4E8;">( st.issuer, quantity );</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">token</span><span style="color:#E1E4E8;">::</span><span style="color:#B392F0;">transfer</span><span style="color:#E1E4E8;">( </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">name</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">from</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                      </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">name</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">to</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                      </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">asset</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;">   </span><span style="color:#FFAB70;">quantity</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                      </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">string</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;">  </span><span style="color:#FFAB70;">memo</span><span style="color:#E1E4E8;"> )</span></span>
<span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">check</span><span style="color:#E1E4E8;">( from </span><span style="color:#F97583;">!=</span><span style="color:#E1E4E8;"> to, </span><span style="color:#9ECBFF;">&quot;cannot transfer to self&quot;</span><span style="color:#E1E4E8;"> );</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">require_auth</span><span style="color:#E1E4E8;">( from );</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">check</span><span style="color:#E1E4E8;">( </span><span style="color:#B392F0;">is_account</span><span style="color:#E1E4E8;">( to ), </span><span style="color:#9ECBFF;">&quot;to account does not exist&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">auto</span><span style="color:#E1E4E8;"> sym </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> quantity.symbol.</span><span style="color:#B392F0;">code</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    stats </span><span style="color:#B392F0;">statstable</span><span style="color:#E1E4E8;">( </span><span style="color:#B392F0;">get_self</span><span style="color:#E1E4E8;">(), sym.</span><span style="color:#B392F0;">raw</span><span style="color:#E1E4E8;">() );</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">auto&amp;</span><span style="color:#E1E4E8;"> st </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> statstable.</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">( sym.</span><span style="color:#B392F0;">raw</span><span style="color:#E1E4E8;">() );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">require_recipient</span><span style="color:#E1E4E8;">( from );</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">require_recipient</span><span style="color:#E1E4E8;">( to );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">check</span><span style="color:#E1E4E8;">( quantity.</span><span style="color:#B392F0;">is_valid</span><span style="color:#E1E4E8;">(), </span><span style="color:#9ECBFF;">&quot;invalid quantity&quot;</span><span style="color:#E1E4E8;"> );</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">check</span><span style="color:#E1E4E8;">( quantity.amount </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;must transfer positive quantity&quot;</span><span style="color:#E1E4E8;"> );</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">check</span><span style="color:#E1E4E8;">( quantity.symbol </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> st.supply.symbol, </span><span style="color:#9ECBFF;">&quot;symbol precision mismatch&quot;</span><span style="color:#E1E4E8;"> );</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">check</span><span style="color:#E1E4E8;">( memo.</span><span style="color:#B392F0;">size</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">&lt;=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">256</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;memo has more than 256 bytes&quot;</span><span style="color:#E1E4E8;"> );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">sub_balance</span><span style="color:#E1E4E8;">( from, quantity );</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">add_balance</span><span style="color:#E1E4E8;">( to, quantity );</span><span style="color:#6A737D;"> // ultra-duncan --- UB-474: support new eosio.token standard</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">token</span><span style="color:#E1E4E8;">::</span><span style="color:#B392F0;">sub_balance</span><span style="color:#E1E4E8;">( </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">name</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">owner</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">asset</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">value</span><span style="color:#E1E4E8;"> ) {</span></span>
<span class="line"><span style="color:#E1E4E8;">   accounts </span><span style="color:#B392F0;">from_acnts</span><span style="color:#E1E4E8;">( </span><span style="color:#B392F0;">get_self</span><span style="color:#E1E4E8;">(), owner.value );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">auto&amp;</span><span style="color:#E1E4E8;"> from </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> from_acnts.</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">( value.symbol.</span><span style="color:#B392F0;">code</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">raw</span><span style="color:#E1E4E8;">(), </span><span style="color:#9ECBFF;">&quot;no balance object found&quot;</span><span style="color:#E1E4E8;"> );</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">check</span><span style="color:#E1E4E8;">( from.balance.amount </span><span style="color:#F97583;">&gt;=</span><span style="color:#E1E4E8;"> value.amount, </span><span style="color:#9ECBFF;">&quot;overdrawn balance&quot;</span><span style="color:#E1E4E8;"> );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">   from_acnts.</span><span style="color:#B392F0;">modify</span><span style="color:#E1E4E8;">( from, same_payer, [</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;">]( </span><span style="color:#F97583;">auto&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">a</span><span style="color:#E1E4E8;"> ) {</span></span>
<span class="line"><span style="color:#E1E4E8;">         a.balance </span><span style="color:#F97583;">-=</span><span style="color:#E1E4E8;"> value;</span></span>
<span class="line"><span style="color:#E1E4E8;">      });</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// ultra-duncan --- UB-474: support new eosio.token standard</span></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">token</span><span style="color:#E1E4E8;">::</span><span style="color:#B392F0;">add_balance</span><span style="color:#E1E4E8;">( </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">name</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">owner</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">asset</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">value</span><span style="color:#E1E4E8;"> )</span></span>
<span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">   accounts </span><span style="color:#B392F0;">to_acnts</span><span style="color:#E1E4E8;">( </span><span style="color:#B392F0;">get_self</span><span style="color:#E1E4E8;">(), owner.value );</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#F97583;">auto</span><span style="color:#E1E4E8;"> to </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> to_acnts.</span><span style="color:#B392F0;">find</span><span style="color:#E1E4E8;">( value.symbol.</span><span style="color:#B392F0;">code</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">raw</span><span style="color:#E1E4E8;">() );</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">check</span><span style="color:#E1E4E8;">( to </span><span style="color:#F97583;">!=</span><span style="color:#E1E4E8;"> to_acnts.</span><span style="color:#B392F0;">end</span><span style="color:#E1E4E8;">(), owner.</span><span style="color:#B392F0;">to_string</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot; to account balance does not exist&quot;</span><span style="color:#E1E4E8;"> );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">   to_acnts.</span><span style="color:#B392F0;">modify</span><span style="color:#E1E4E8;">( to, same_payer, [</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;">]( </span><span style="color:#F97583;">auto&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">a</span><span style="color:#E1E4E8;"> ) {</span></span>
<span class="line"><span style="color:#E1E4E8;">      a.balance </span><span style="color:#F97583;">+=</span><span style="color:#E1E4E8;"> value;</span></span>
<span class="line"><span style="color:#E1E4E8;">   });</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">token</span><span style="color:#E1E4E8;">::</span><span style="color:#B392F0;">open</span><span style="color:#E1E4E8;">( </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">name</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">owner</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">symbol</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">symbol</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">name</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">ram_payer</span><span style="color:#E1E4E8;"> )</span></span>
<span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">require_auth</span><span style="color:#E1E4E8;">( ram_payer );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">check</span><span style="color:#E1E4E8;">( </span><span style="color:#B392F0;">is_account</span><span style="color:#E1E4E8;">( owner ), </span><span style="color:#9ECBFF;">&quot;owner account does not exist&quot;</span><span style="color:#E1E4E8;"> );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#F97583;">auto</span><span style="color:#E1E4E8;"> sym_code_raw </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> symbol.</span><span style="color:#B392F0;">code</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">raw</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">   stats </span><span style="color:#B392F0;">statstable</span><span style="color:#E1E4E8;">( </span><span style="color:#B392F0;">get_self</span><span style="color:#E1E4E8;">(), sym_code_raw );</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">auto&amp;</span><span style="color:#E1E4E8;"> st </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> statstable.</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">( sym_code_raw, </span><span style="color:#9ECBFF;">&quot;symbol does not exist&quot;</span><span style="color:#E1E4E8;"> );</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">check</span><span style="color:#E1E4E8;">( st.supply.symbol </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> symbol, </span><span style="color:#9ECBFF;">&quot;symbol precision mismatch&quot;</span><span style="color:#E1E4E8;"> );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">   accounts </span><span style="color:#B392F0;">acnts</span><span style="color:#E1E4E8;">( </span><span style="color:#B392F0;">get_self</span><span style="color:#E1E4E8;">(), owner.value );</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#F97583;">auto</span><span style="color:#E1E4E8;"> it </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> acnts.</span><span style="color:#B392F0;">find</span><span style="color:#E1E4E8;">( sym_code_raw );</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;">( it </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> acnts.</span><span style="color:#B392F0;">end</span><span style="color:#E1E4E8;">() ) {</span></span>
<span class="line"><span style="color:#E1E4E8;">      acnts.</span><span style="color:#B392F0;">emplace</span><span style="color:#E1E4E8;">( ram_payer, [</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;">]( </span><span style="color:#F97583;">auto&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">a</span><span style="color:#E1E4E8;"> ){</span></span>
<span class="line"><span style="color:#E1E4E8;">        a.balance </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> asset{</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">, symbol};</span></span>
<span class="line"><span style="color:#E1E4E8;">      });</span></span>
<span class="line"><span style="color:#E1E4E8;">   }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">token</span><span style="color:#E1E4E8;">::</span><span style="color:#B392F0;">close</span><span style="color:#E1E4E8;">( </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">name</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">owner</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">symbol</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">symbol</span><span style="color:#E1E4E8;"> )</span></span>
<span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">require_auth</span><span style="color:#E1E4E8;">( owner );</span></span>
<span class="line"><span style="color:#E1E4E8;">   accounts </span><span style="color:#B392F0;">acnts</span><span style="color:#E1E4E8;">( </span><span style="color:#B392F0;">get_self</span><span style="color:#E1E4E8;">(), owner.value );</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#F97583;">auto</span><span style="color:#E1E4E8;"> it </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> acnts.</span><span style="color:#B392F0;">find</span><span style="color:#E1E4E8;">( symbol.</span><span style="color:#B392F0;">code</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">raw</span><span style="color:#E1E4E8;">() );</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">check</span><span style="color:#E1E4E8;">( it </span><span style="color:#F97583;">!=</span><span style="color:#E1E4E8;"> acnts.</span><span style="color:#B392F0;">end</span><span style="color:#E1E4E8;">(), </span><span style="color:#9ECBFF;">&quot;Balance row already deleted or never existed. Action won&#39;t have any effect.&quot;</span><span style="color:#E1E4E8;"> );</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">check</span><span style="color:#E1E4E8;">( it-&gt;balance.amount </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;Cannot close because the balance is not zero.&quot;</span><span style="color:#E1E4E8;"> );</span></span>
<span class="line"><span style="color:#E1E4E8;">   acnts.</span><span style="color:#B392F0;">erase</span><span style="color:#E1E4E8;">( it );</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">}</span><span style="color:#6A737D;"> /// namespace eosio</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&lt;eosio.token/eosio.token.hpp&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">namespace</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">eosio</span><span style="color:#24292E;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">token</span><span style="color:#24292E;">::</span><span style="color:#6F42C1;">create</span><span style="color:#24292E;">( </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">name</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;">   </span><span style="color:#E36209;">issuer</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">asset</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;">  </span><span style="color:#E36209;">maximum_supply</span><span style="color:#24292E;"> )</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">require_auth</span><span style="color:#24292E;">( </span><span style="color:#6F42C1;">get_self</span><span style="color:#24292E;">() );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">auto</span><span style="color:#24292E;"> sym </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> maximum_supply.symbol;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">check</span><span style="color:#24292E;">( sym.</span><span style="color:#6F42C1;">is_valid</span><span style="color:#24292E;">(), </span><span style="color:#032F62;">&quot;invalid symbol name&quot;</span><span style="color:#24292E;"> );</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">check</span><span style="color:#24292E;">( maximum_supply.</span><span style="color:#6F42C1;">is_valid</span><span style="color:#24292E;">(), </span><span style="color:#032F62;">&quot;invalid supply&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">check</span><span style="color:#24292E;">( maximum_supply.amount </span><span style="color:#D73A49;">&gt;=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;max-supply must not be negative&quot;</span><span style="color:#24292E;">);</span><span style="color:#6A737D;"> // ultra-duncan --- support for unlimitted max supply</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    stats </span><span style="color:#6F42C1;">statstable</span><span style="color:#24292E;">( </span><span style="color:#6F42C1;">get_self</span><span style="color:#24292E;">(), sym.</span><span style="color:#6F42C1;">code</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">raw</span><span style="color:#24292E;">() );</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">auto</span><span style="color:#24292E;"> existing </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> statstable.</span><span style="color:#6F42C1;">find</span><span style="color:#24292E;">( sym.</span><span style="color:#6F42C1;">code</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">raw</span><span style="color:#24292E;">() );</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">check</span><span style="color:#24292E;">( existing </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> statstable.</span><span style="color:#6F42C1;">end</span><span style="color:#24292E;">(), </span><span style="color:#032F62;">&quot;token with symbol already exists&quot;</span><span style="color:#24292E;"> );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    statstable.</span><span style="color:#6F42C1;">emplace</span><span style="color:#24292E;">( </span><span style="color:#6F42C1;">get_self</span><span style="color:#24292E;">(), [</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;">]( </span><span style="color:#D73A49;">auto&amp;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">s</span><span style="color:#24292E;"> ) {</span></span>
<span class="line"><span style="color:#24292E;">       s.supply.symbol </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> maximum_supply.symbol;</span></span>
<span class="line"><span style="color:#24292E;">       s.max_supply    </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> maximum_supply;</span></span>
<span class="line"><span style="color:#24292E;">       s.issuer        </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> issuer;</span></span>
<span class="line"><span style="color:#24292E;">    });</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">token</span><span style="color:#24292E;">::</span><span style="color:#6F42C1;">issue</span><span style="color:#24292E;">( </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">name</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">to</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">asset</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">quantity</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">string</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">memo</span><span style="color:#24292E;"> )</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">auto</span><span style="color:#24292E;"> sym </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> quantity.symbol;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">check</span><span style="color:#24292E;">( sym.</span><span style="color:#6F42C1;">is_valid</span><span style="color:#24292E;">(), </span><span style="color:#032F62;">&quot;invalid symbol name&quot;</span><span style="color:#24292E;"> );</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">check</span><span style="color:#24292E;">( memo.</span><span style="color:#6F42C1;">size</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">&lt;=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">256</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;memo has more than 256 bytes&quot;</span><span style="color:#24292E;"> );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    stats </span><span style="color:#6F42C1;">statstable</span><span style="color:#24292E;">( </span><span style="color:#6F42C1;">get_self</span><span style="color:#24292E;">(), sym.</span><span style="color:#6F42C1;">code</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">raw</span><span style="color:#24292E;">() );</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">auto</span><span style="color:#24292E;"> existing </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> statstable.</span><span style="color:#6F42C1;">find</span><span style="color:#24292E;">( sym.</span><span style="color:#6F42C1;">code</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">raw</span><span style="color:#24292E;">() );</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">check</span><span style="color:#24292E;">( existing </span><span style="color:#D73A49;">!=</span><span style="color:#24292E;"> statstable.</span><span style="color:#6F42C1;">end</span><span style="color:#24292E;">(), </span><span style="color:#032F62;">&quot;token with symbol does not exist, create token before issue&quot;</span><span style="color:#24292E;"> );</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">auto&amp;</span><span style="color:#24292E;"> st </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">*</span><span style="color:#24292E;">existing;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">check</span><span style="color:#24292E;">( to </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> st.issuer, </span><span style="color:#032F62;">&quot;tokens can only be issued to issuer account&quot;</span><span style="color:#24292E;"> );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">require_auth</span><span style="color:#24292E;">( st.issuer );</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">check</span><span style="color:#24292E;">( quantity.</span><span style="color:#6F42C1;">is_valid</span><span style="color:#24292E;">(), </span><span style="color:#032F62;">&quot;invalid quantity&quot;</span><span style="color:#24292E;"> );</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">check</span><span style="color:#24292E;">( quantity.amount </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;must issue positive quantity&quot;</span><span style="color:#24292E;"> );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">check</span><span style="color:#24292E;">( quantity.symbol </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> st.supply.symbol, </span><span style="color:#032F62;">&quot;symbol precision mismatch&quot;</span><span style="color:#24292E;"> );</span></span>
<span class="line"><span style="color:#6A737D;">    // ultra-duncan --- support for unlimitted max supply</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (st.max_supply.amount </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">check</span><span style="color:#24292E;">( quantity.amount </span><span style="color:#D73A49;">&lt;=</span><span style="color:#24292E;"> st.max_supply.amount </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> st.supply.amount, </span><span style="color:#032F62;">&quot;quantity exceeds available supply&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    statstable.</span><span style="color:#6F42C1;">modify</span><span style="color:#24292E;">( st, same_payer, [</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;">]( </span><span style="color:#D73A49;">auto&amp;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">s</span><span style="color:#24292E;"> ) {</span></span>
<span class="line"><span style="color:#24292E;">       s.supply </span><span style="color:#D73A49;">+=</span><span style="color:#24292E;"> quantity;</span></span>
<span class="line"><span style="color:#24292E;">    });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">add_balance</span><span style="color:#24292E;">( st.issuer, quantity );</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">token</span><span style="color:#24292E;">::</span><span style="color:#6F42C1;">retire</span><span style="color:#24292E;">( </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">asset</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">quantity</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">string</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">memo</span><span style="color:#24292E;"> )</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">auto</span><span style="color:#24292E;"> sym </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> quantity.symbol;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">check</span><span style="color:#24292E;">( sym.</span><span style="color:#6F42C1;">is_valid</span><span style="color:#24292E;">(), </span><span style="color:#032F62;">&quot;invalid symbol name&quot;</span><span style="color:#24292E;"> );</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">check</span><span style="color:#24292E;">( memo.</span><span style="color:#6F42C1;">size</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">&lt;=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">256</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;memo has more than 256 bytes&quot;</span><span style="color:#24292E;"> );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    stats </span><span style="color:#6F42C1;">statstable</span><span style="color:#24292E;">( </span><span style="color:#6F42C1;">get_self</span><span style="color:#24292E;">(), sym.</span><span style="color:#6F42C1;">code</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">raw</span><span style="color:#24292E;">() );</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">auto</span><span style="color:#24292E;"> existing </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> statstable.</span><span style="color:#6F42C1;">find</span><span style="color:#24292E;">( sym.</span><span style="color:#6F42C1;">code</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">raw</span><span style="color:#24292E;">() );</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">check</span><span style="color:#24292E;">( existing </span><span style="color:#D73A49;">!=</span><span style="color:#24292E;"> statstable.</span><span style="color:#6F42C1;">end</span><span style="color:#24292E;">(), </span><span style="color:#032F62;">&quot;token with symbol does not exist&quot;</span><span style="color:#24292E;"> );</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">auto&amp;</span><span style="color:#24292E;"> st </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">*</span><span style="color:#24292E;">existing;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">require_auth</span><span style="color:#24292E;">( st.issuer );</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">check</span><span style="color:#24292E;">( quantity.</span><span style="color:#6F42C1;">is_valid</span><span style="color:#24292E;">(), </span><span style="color:#032F62;">&quot;invalid quantity&quot;</span><span style="color:#24292E;"> );</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">check</span><span style="color:#24292E;">( quantity.amount </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;must retire positive quantity&quot;</span><span style="color:#24292E;"> );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">check</span><span style="color:#24292E;">( quantity.symbol </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> st.supply.symbol, </span><span style="color:#032F62;">&quot;symbol precision mismatch&quot;</span><span style="color:#24292E;"> );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    statstable.</span><span style="color:#6F42C1;">modify</span><span style="color:#24292E;">( st, same_payer, [</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;">]( </span><span style="color:#D73A49;">auto&amp;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">s</span><span style="color:#24292E;"> ) {</span></span>
<span class="line"><span style="color:#24292E;">       s.supply </span><span style="color:#D73A49;">-=</span><span style="color:#24292E;"> quantity;</span></span>
<span class="line"><span style="color:#24292E;">    });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">sub_balance</span><span style="color:#24292E;">( st.issuer, quantity );</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">token</span><span style="color:#24292E;">::</span><span style="color:#6F42C1;">transfer</span><span style="color:#24292E;">( </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">name</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;">    </span><span style="color:#E36209;">from</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                      </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">name</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;">    </span><span style="color:#E36209;">to</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                      </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">asset</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;">   </span><span style="color:#E36209;">quantity</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                      </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">string</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;">  </span><span style="color:#E36209;">memo</span><span style="color:#24292E;"> )</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">check</span><span style="color:#24292E;">( from </span><span style="color:#D73A49;">!=</span><span style="color:#24292E;"> to, </span><span style="color:#032F62;">&quot;cannot transfer to self&quot;</span><span style="color:#24292E;"> );</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">require_auth</span><span style="color:#24292E;">( from );</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">check</span><span style="color:#24292E;">( </span><span style="color:#6F42C1;">is_account</span><span style="color:#24292E;">( to ), </span><span style="color:#032F62;">&quot;to account does not exist&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">auto</span><span style="color:#24292E;"> sym </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> quantity.symbol.</span><span style="color:#6F42C1;">code</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    stats </span><span style="color:#6F42C1;">statstable</span><span style="color:#24292E;">( </span><span style="color:#6F42C1;">get_self</span><span style="color:#24292E;">(), sym.</span><span style="color:#6F42C1;">raw</span><span style="color:#24292E;">() );</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">auto&amp;</span><span style="color:#24292E;"> st </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> statstable.</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">( sym.</span><span style="color:#6F42C1;">raw</span><span style="color:#24292E;">() );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">require_recipient</span><span style="color:#24292E;">( from );</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">require_recipient</span><span style="color:#24292E;">( to );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">check</span><span style="color:#24292E;">( quantity.</span><span style="color:#6F42C1;">is_valid</span><span style="color:#24292E;">(), </span><span style="color:#032F62;">&quot;invalid quantity&quot;</span><span style="color:#24292E;"> );</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">check</span><span style="color:#24292E;">( quantity.amount </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;must transfer positive quantity&quot;</span><span style="color:#24292E;"> );</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">check</span><span style="color:#24292E;">( quantity.symbol </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> st.supply.symbol, </span><span style="color:#032F62;">&quot;symbol precision mismatch&quot;</span><span style="color:#24292E;"> );</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">check</span><span style="color:#24292E;">( memo.</span><span style="color:#6F42C1;">size</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">&lt;=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">256</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;memo has more than 256 bytes&quot;</span><span style="color:#24292E;"> );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">sub_balance</span><span style="color:#24292E;">( from, quantity );</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">add_balance</span><span style="color:#24292E;">( to, quantity );</span><span style="color:#6A737D;"> // ultra-duncan --- UB-474: support new eosio.token standard</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">token</span><span style="color:#24292E;">::</span><span style="color:#6F42C1;">sub_balance</span><span style="color:#24292E;">( </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">name</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">owner</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">asset</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">value</span><span style="color:#24292E;"> ) {</span></span>
<span class="line"><span style="color:#24292E;">   accounts </span><span style="color:#6F42C1;">from_acnts</span><span style="color:#24292E;">( </span><span style="color:#6F42C1;">get_self</span><span style="color:#24292E;">(), owner.value );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">auto&amp;</span><span style="color:#24292E;"> from </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> from_acnts.</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">( value.symbol.</span><span style="color:#6F42C1;">code</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">raw</span><span style="color:#24292E;">(), </span><span style="color:#032F62;">&quot;no balance object found&quot;</span><span style="color:#24292E;"> );</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">check</span><span style="color:#24292E;">( from.balance.amount </span><span style="color:#D73A49;">&gt;=</span><span style="color:#24292E;"> value.amount, </span><span style="color:#032F62;">&quot;overdrawn balance&quot;</span><span style="color:#24292E;"> );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">   from_acnts.</span><span style="color:#6F42C1;">modify</span><span style="color:#24292E;">( from, same_payer, [</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;">]( </span><span style="color:#D73A49;">auto&amp;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">a</span><span style="color:#24292E;"> ) {</span></span>
<span class="line"><span style="color:#24292E;">         a.balance </span><span style="color:#D73A49;">-=</span><span style="color:#24292E;"> value;</span></span>
<span class="line"><span style="color:#24292E;">      });</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// ultra-duncan --- UB-474: support new eosio.token standard</span></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">token</span><span style="color:#24292E;">::</span><span style="color:#6F42C1;">add_balance</span><span style="color:#24292E;">( </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">name</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">owner</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">asset</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">value</span><span style="color:#24292E;"> )</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">   accounts </span><span style="color:#6F42C1;">to_acnts</span><span style="color:#24292E;">( </span><span style="color:#6F42C1;">get_self</span><span style="color:#24292E;">(), owner.value );</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#D73A49;">auto</span><span style="color:#24292E;"> to </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> to_acnts.</span><span style="color:#6F42C1;">find</span><span style="color:#24292E;">( value.symbol.</span><span style="color:#6F42C1;">code</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">raw</span><span style="color:#24292E;">() );</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">check</span><span style="color:#24292E;">( to </span><span style="color:#D73A49;">!=</span><span style="color:#24292E;"> to_acnts.</span><span style="color:#6F42C1;">end</span><span style="color:#24292E;">(), owner.</span><span style="color:#6F42C1;">to_string</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot; to account balance does not exist&quot;</span><span style="color:#24292E;"> );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">   to_acnts.</span><span style="color:#6F42C1;">modify</span><span style="color:#24292E;">( to, same_payer, [</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;">]( </span><span style="color:#D73A49;">auto&amp;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">a</span><span style="color:#24292E;"> ) {</span></span>
<span class="line"><span style="color:#24292E;">      a.balance </span><span style="color:#D73A49;">+=</span><span style="color:#24292E;"> value;</span></span>
<span class="line"><span style="color:#24292E;">   });</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">token</span><span style="color:#24292E;">::</span><span style="color:#6F42C1;">open</span><span style="color:#24292E;">( </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">name</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">owner</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">symbol</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">symbol</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">name</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">ram_payer</span><span style="color:#24292E;"> )</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">require_auth</span><span style="color:#24292E;">( ram_payer );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">check</span><span style="color:#24292E;">( </span><span style="color:#6F42C1;">is_account</span><span style="color:#24292E;">( owner ), </span><span style="color:#032F62;">&quot;owner account does not exist&quot;</span><span style="color:#24292E;"> );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#D73A49;">auto</span><span style="color:#24292E;"> sym_code_raw </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> symbol.</span><span style="color:#6F42C1;">code</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">raw</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">   stats </span><span style="color:#6F42C1;">statstable</span><span style="color:#24292E;">( </span><span style="color:#6F42C1;">get_self</span><span style="color:#24292E;">(), sym_code_raw );</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">auto&amp;</span><span style="color:#24292E;"> st </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> statstable.</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">( sym_code_raw, </span><span style="color:#032F62;">&quot;symbol does not exist&quot;</span><span style="color:#24292E;"> );</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">check</span><span style="color:#24292E;">( st.supply.symbol </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> symbol, </span><span style="color:#032F62;">&quot;symbol precision mismatch&quot;</span><span style="color:#24292E;"> );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">   accounts </span><span style="color:#6F42C1;">acnts</span><span style="color:#24292E;">( </span><span style="color:#6F42C1;">get_self</span><span style="color:#24292E;">(), owner.value );</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#D73A49;">auto</span><span style="color:#24292E;"> it </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> acnts.</span><span style="color:#6F42C1;">find</span><span style="color:#24292E;">( sym_code_raw );</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#D73A49;">if</span><span style="color:#24292E;">( it </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> acnts.</span><span style="color:#6F42C1;">end</span><span style="color:#24292E;">() ) {</span></span>
<span class="line"><span style="color:#24292E;">      acnts.</span><span style="color:#6F42C1;">emplace</span><span style="color:#24292E;">( ram_payer, [</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;">]( </span><span style="color:#D73A49;">auto&amp;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">a</span><span style="color:#24292E;"> ){</span></span>
<span class="line"><span style="color:#24292E;">        a.balance </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> asset{</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">, symbol};</span></span>
<span class="line"><span style="color:#24292E;">      });</span></span>
<span class="line"><span style="color:#24292E;">   }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">token</span><span style="color:#24292E;">::</span><span style="color:#6F42C1;">close</span><span style="color:#24292E;">( </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">name</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">owner</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">symbol</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">symbol</span><span style="color:#24292E;"> )</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">require_auth</span><span style="color:#24292E;">( owner );</span></span>
<span class="line"><span style="color:#24292E;">   accounts </span><span style="color:#6F42C1;">acnts</span><span style="color:#24292E;">( </span><span style="color:#6F42C1;">get_self</span><span style="color:#24292E;">(), owner.value );</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#D73A49;">auto</span><span style="color:#24292E;"> it </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> acnts.</span><span style="color:#6F42C1;">find</span><span style="color:#24292E;">( symbol.</span><span style="color:#6F42C1;">code</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">raw</span><span style="color:#24292E;">() );</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">check</span><span style="color:#24292E;">( it </span><span style="color:#D73A49;">!=</span><span style="color:#24292E;"> acnts.</span><span style="color:#6F42C1;">end</span><span style="color:#24292E;">(), </span><span style="color:#032F62;">&quot;Balance row already deleted or never existed. Action won&#39;t have any effect.&quot;</span><span style="color:#24292E;"> );</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">check</span><span style="color:#24292E;">( it-&gt;balance.amount </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;Cannot close because the balance is not zero.&quot;</span><span style="color:#24292E;"> );</span></span>
<span class="line"><span style="color:#24292E;">   acnts.</span><span style="color:#6F42C1;">erase</span><span style="color:#24292E;">( it );</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">}</span><span style="color:#6A737D;"> /// namespace eosio</span></span></code></pre></div><h2 id="include-eosio-token-eosio-token-hpp" tabindex="-1">include/eosio.token/eosio.token.hpp <a class="header-anchor" href="#include-eosio-token-eosio-token-hpp" aria-label="Permalink to &quot;include/eosio.token/eosio.token.hpp&quot;">​</a></h2><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">#pragma</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">once</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&lt;eosio/asset.hpp&gt;</span></span>
<span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&lt;eosio/eosio.hpp&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&lt;string&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">namespace</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">eosiosystem</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">system_contract</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">namespace</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">eosio</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#F97583;">using</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">std</span><span style="color:#E1E4E8;">::string;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">   /**</span></span>
<span class="line"><span style="color:#6A737D;">    * eosio.token contract defines the structures and actions that allow users to create, issue, and manage</span></span>
<span class="line"><span style="color:#6A737D;">    * tokens on EOSIO based blockchains.</span></span>
<span class="line"><span style="color:#6A737D;">    */</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">[[</span><span style="color:#B392F0;">eosio</span><span style="color:#79B8FF;">::</span><span style="color:#B392F0;">contract</span><span style="color:#79B8FF;">(</span><span style="color:#9ECBFF;">&quot;eosio.token&quot;</span><span style="color:#79B8FF;">)]]</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">token</span><span style="color:#E1E4E8;"> : </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">contract</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#F97583;">public:</span></span>
<span class="line"><span style="color:#E1E4E8;">         </span><span style="color:#F97583;">using</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">contract</span><span style="color:#E1E4E8;">::contract;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">         /**</span></span>
<span class="line"><span style="color:#6A737D;">          * Allows \`issuer\` account to create a token in supply of \`maximum_supply\`. If validation is successful a new entry in statstable for token symbol scope gets created.</span></span>
<span class="line"><span style="color:#6A737D;">          *</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#F97583;">@param</span><span style="color:#6A737D;"> </span><span style="color:#FFAB70;">issuer</span><span style="color:#6A737D;"> - the account that creates the token,</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#F97583;">@param</span><span style="color:#6A737D;"> </span><span style="color:#FFAB70;">maximum_supply</span><span style="color:#6A737D;"> - the maximum supply set for the token created.</span></span>
<span class="line"><span style="color:#6A737D;">          *</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#F97583;">@pre</span><span style="color:#6A737D;"> Token symbol has to be valid,</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#F97583;">@pre</span><span style="color:#6A737D;"> Token symbol must not be already created,</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#F97583;">@pre</span><span style="color:#6A737D;"> maximum_supply has to be smaller than the maximum supply allowed by the system: 1^62 - 1.</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#F97583;">@pre</span><span style="color:#6A737D;"> Maximum supply must be positive;</span></span>
<span class="line"><span style="color:#6A737D;">          */</span></span>
<span class="line"><span style="color:#E1E4E8;">         </span><span style="color:#79B8FF;">[[</span><span style="color:#B392F0;">eosio</span><span style="color:#79B8FF;">::</span><span style="color:#B392F0;">action</span><span style="color:#79B8FF;">]]</span></span>
<span class="line"><span style="color:#E1E4E8;">         </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">create</span><span style="color:#E1E4E8;">( </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">name</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;">   </span><span style="color:#FFAB70;">issuer</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                      </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">asset</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;">  </span><span style="color:#FFAB70;">maximum_supply</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#6A737D;">         /**</span></span>
<span class="line"><span style="color:#6A737D;">          *  This action issues to \`to\` account a \`quantity\` of tokens.</span></span>
<span class="line"><span style="color:#6A737D;">          *</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#F97583;">@param</span><span style="color:#6A737D;"> </span><span style="color:#FFAB70;">to</span><span style="color:#6A737D;"> - the account to issue tokens to, it must be the same as the issuer,</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#F97583;">@param</span><span style="color:#6A737D;"> </span><span style="color:#FFAB70;">quntity</span><span style="color:#6A737D;"> - the amount of tokens to be issued,</span></span>
<span class="line"><span style="color:#6A737D;">          * @memo - the memo string that accompanies the token issue transaction.</span></span>
<span class="line"><span style="color:#6A737D;">          */</span></span>
<span class="line"><span style="color:#E1E4E8;">         </span><span style="color:#79B8FF;">[[</span><span style="color:#B392F0;">eosio</span><span style="color:#79B8FF;">::</span><span style="color:#B392F0;">action</span><span style="color:#79B8FF;">]]</span></span>
<span class="line"><span style="color:#E1E4E8;">         </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">issue</span><span style="color:#E1E4E8;">( </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">name</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">to</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">asset</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">quantity</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">string</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">memo</span><span style="color:#E1E4E8;"> );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">         /**</span></span>
<span class="line"><span style="color:#6A737D;">          * The opposite for create action, if all validations succeed,</span></span>
<span class="line"><span style="color:#6A737D;">          * it debits the statstable.supply amount.</span></span>
<span class="line"><span style="color:#6A737D;">          *</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#F97583;">@param</span><span style="color:#6A737D;"> </span><span style="color:#FFAB70;">quantity</span><span style="color:#6A737D;"> - the quantity of tokens to retire,</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#F97583;">@param</span><span style="color:#6A737D;"> </span><span style="color:#FFAB70;">memo</span><span style="color:#6A737D;"> - the memo string to accompany the transaction.</span></span>
<span class="line"><span style="color:#6A737D;">          */</span></span>
<span class="line"><span style="color:#E1E4E8;">         </span><span style="color:#79B8FF;">[[</span><span style="color:#B392F0;">eosio</span><span style="color:#79B8FF;">::</span><span style="color:#B392F0;">action</span><span style="color:#79B8FF;">]]</span></span>
<span class="line"><span style="color:#E1E4E8;">         </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">retire</span><span style="color:#E1E4E8;">( </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">asset</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">quantity</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">string</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">memo</span><span style="color:#E1E4E8;"> );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">         /**</span></span>
<span class="line"><span style="color:#6A737D;">          * Allows \`from\` account to transfer to \`to\` account the \`quantity\` tokens.</span></span>
<span class="line"><span style="color:#6A737D;">          * One account is debited and the other is credited with quantity tokens.</span></span>
<span class="line"><span style="color:#6A737D;">          *</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#F97583;">@param</span><span style="color:#6A737D;"> </span><span style="color:#FFAB70;">from</span><span style="color:#6A737D;"> - the account to transfer from,</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#F97583;">@param</span><span style="color:#6A737D;"> </span><span style="color:#FFAB70;">to</span><span style="color:#6A737D;"> - the account to be transferred to,</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#F97583;">@param</span><span style="color:#6A737D;"> </span><span style="color:#FFAB70;">quantity</span><span style="color:#6A737D;"> - the quantity of tokens to be transferred,</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#F97583;">@param</span><span style="color:#6A737D;"> </span><span style="color:#FFAB70;">memo</span><span style="color:#6A737D;"> - the memo string to accompany the transaction.</span></span>
<span class="line"><span style="color:#6A737D;">          */</span></span>
<span class="line"><span style="color:#E1E4E8;">         </span><span style="color:#79B8FF;">[[</span><span style="color:#B392F0;">eosio</span><span style="color:#79B8FF;">::</span><span style="color:#B392F0;">action</span><span style="color:#79B8FF;">]]</span></span>
<span class="line"><span style="color:#E1E4E8;">         </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">transfer</span><span style="color:#E1E4E8;">( </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">name</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">from</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                        </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">name</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">to</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                        </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">asset</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;">   </span><span style="color:#FFAB70;">quantity</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                        </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">string</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;">  </span><span style="color:#FFAB70;">memo</span><span style="color:#E1E4E8;"> );</span></span>
<span class="line"><span style="color:#6A737D;">         /**</span></span>
<span class="line"><span style="color:#6A737D;">          * Allows \`ram_payer\` to create an account \`owner\` with zero balance for</span></span>
<span class="line"><span style="color:#6A737D;">          * token \`symbol\` at the expense of \`ram_payer\`.</span></span>
<span class="line"><span style="color:#6A737D;">          *</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#F97583;">@param</span><span style="color:#6A737D;"> </span><span style="color:#FFAB70;">owner</span><span style="color:#6A737D;"> - the account to be created,</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#F97583;">@param</span><span style="color:#6A737D;"> </span><span style="color:#FFAB70;">symbol</span><span style="color:#6A737D;"> - the token to be payed with by \`ram_payer\`,</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#F97583;">@param</span><span style="color:#6A737D;"> </span><span style="color:#FFAB70;">ram_payer</span><span style="color:#6A737D;"> - the account that supports the cost of this action.</span></span>
<span class="line"><span style="color:#6A737D;">          *</span></span>
<span class="line"><span style="color:#6A737D;">          * More information can be read [here](https://github.com/EOSIO/eosio.contracts/issues/62)</span></span>
<span class="line"><span style="color:#6A737D;">          * and [here](https://github.com/EOSIO/eosio.contracts/issues/61).</span></span>
<span class="line"><span style="color:#6A737D;">          */</span></span>
<span class="line"><span style="color:#E1E4E8;">         </span><span style="color:#79B8FF;">[[</span><span style="color:#B392F0;">eosio</span><span style="color:#79B8FF;">::</span><span style="color:#B392F0;">action</span><span style="color:#79B8FF;">]]</span></span>
<span class="line"><span style="color:#E1E4E8;">         </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">open</span><span style="color:#E1E4E8;">( </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">name</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">owner</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">symbol</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">symbol</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">name</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">ram_payer</span><span style="color:#E1E4E8;"> );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">         /**</span></span>
<span class="line"><span style="color:#6A737D;">          * This action is the opposite for open, it closes the account \`owner\`</span></span>
<span class="line"><span style="color:#6A737D;">          * for token \`symbol\`.</span></span>
<span class="line"><span style="color:#6A737D;">          *</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#F97583;">@param</span><span style="color:#6A737D;"> </span><span style="color:#FFAB70;">owner</span><span style="color:#6A737D;"> - the owner account to execute the close action for,</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#F97583;">@param</span><span style="color:#6A737D;"> </span><span style="color:#FFAB70;">symbol</span><span style="color:#6A737D;"> - the symbol of the token to execute the close action for.</span></span>
<span class="line"><span style="color:#6A737D;">          *</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#F97583;">@pre</span><span style="color:#6A737D;"> The pair of owner plus symbol has to exist otherwise no action is executed,</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#F97583;">@pre</span><span style="color:#6A737D;"> If the pair of owner plus symbol exists, the balance has to be zero.</span></span>
<span class="line"><span style="color:#6A737D;">          */</span></span>
<span class="line"><span style="color:#E1E4E8;">         </span><span style="color:#79B8FF;">[[</span><span style="color:#B392F0;">eosio</span><span style="color:#79B8FF;">::</span><span style="color:#B392F0;">action</span><span style="color:#79B8FF;">]]</span></span>
<span class="line"><span style="color:#E1E4E8;">         </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">close</span><span style="color:#E1E4E8;">( </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">name</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">owner</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">symbol</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">symbol</span><span style="color:#E1E4E8;"> );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">         </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">asset</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">get_supply</span><span style="color:#E1E4E8;">( </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">name</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">token_contract_account</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">symbol_code</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">sym_code</span><span style="color:#E1E4E8;"> )</span></span>
<span class="line"><span style="color:#E1E4E8;">         {</span></span>
<span class="line"><span style="color:#E1E4E8;">            stats </span><span style="color:#B392F0;">statstable</span><span style="color:#E1E4E8;">( token_contract_account, sym_code.</span><span style="color:#B392F0;">raw</span><span style="color:#E1E4E8;">() );</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">auto&amp;</span><span style="color:#E1E4E8;"> st </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> statstable.</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">( sym_code.</span><span style="color:#B392F0;">raw</span><span style="color:#E1E4E8;">() );</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> st.supply;</span></span>
<span class="line"><span style="color:#E1E4E8;">         }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">         </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">asset</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">get_balance</span><span style="color:#E1E4E8;">( </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">name</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">token_contract_account</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">name</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">owner</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">symbol_code</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">sym_code</span><span style="color:#E1E4E8;"> )</span></span>
<span class="line"><span style="color:#E1E4E8;">         {</span></span>
<span class="line"><span style="color:#E1E4E8;">            accounts </span><span style="color:#B392F0;">accountstable</span><span style="color:#E1E4E8;">( token_contract_account, owner.value );</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">auto&amp;</span><span style="color:#E1E4E8;"> ac </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> accountstable.</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">( sym_code.</span><span style="color:#B392F0;">raw</span><span style="color:#E1E4E8;">() );</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> ac.balance;</span></span>
<span class="line"><span style="color:#E1E4E8;">         }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">         </span><span style="color:#F97583;">using</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">create_action</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">eosio</span><span style="color:#E1E4E8;">::</span><span style="color:#B392F0;">action_wrapper</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#9ECBFF;">&quot;create&quot;</span><span style="color:#F97583;">_n</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">&amp;</span><span style="color:#B392F0;">token</span><span style="color:#E1E4E8;">::</span><span style="color:#B392F0;">create</span><span style="color:#E1E4E8;">&gt;;</span></span>
<span class="line"><span style="color:#E1E4E8;">         </span><span style="color:#F97583;">using</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">issue_action</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">eosio</span><span style="color:#E1E4E8;">::</span><span style="color:#B392F0;">action_wrapper</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#9ECBFF;">&quot;issue&quot;</span><span style="color:#F97583;">_n</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">&amp;</span><span style="color:#B392F0;">token</span><span style="color:#E1E4E8;">::</span><span style="color:#B392F0;">issue</span><span style="color:#E1E4E8;">&gt;;</span></span>
<span class="line"><span style="color:#E1E4E8;">         </span><span style="color:#F97583;">using</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">retire_action</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">eosio</span><span style="color:#E1E4E8;">::</span><span style="color:#B392F0;">action_wrapper</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#9ECBFF;">&quot;retire&quot;</span><span style="color:#F97583;">_n</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">&amp;</span><span style="color:#B392F0;">token</span><span style="color:#E1E4E8;">::</span><span style="color:#B392F0;">retire</span><span style="color:#E1E4E8;">&gt;;</span></span>
<span class="line"><span style="color:#E1E4E8;">         </span><span style="color:#F97583;">using</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">transfer_action</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">eosio</span><span style="color:#E1E4E8;">::</span><span style="color:#B392F0;">action_wrapper</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#9ECBFF;">&quot;transfer&quot;</span><span style="color:#F97583;">_n</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">&amp;</span><span style="color:#B392F0;">token</span><span style="color:#E1E4E8;">::</span><span style="color:#B392F0;">transfer</span><span style="color:#E1E4E8;">&gt;;</span></span>
<span class="line"><span style="color:#E1E4E8;">         </span><span style="color:#F97583;">using</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">open_action</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">eosio</span><span style="color:#E1E4E8;">::</span><span style="color:#B392F0;">action_wrapper</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#9ECBFF;">&quot;open&quot;</span><span style="color:#F97583;">_n</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">&amp;</span><span style="color:#B392F0;">token</span><span style="color:#E1E4E8;">::</span><span style="color:#B392F0;">open</span><span style="color:#E1E4E8;">&gt;;</span></span>
<span class="line"><span style="color:#E1E4E8;">         </span><span style="color:#F97583;">using</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">close_action</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">eosio</span><span style="color:#E1E4E8;">::</span><span style="color:#B392F0;">action_wrapper</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#9ECBFF;">&quot;close&quot;</span><span style="color:#F97583;">_n</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">&amp;</span><span style="color:#B392F0;">token</span><span style="color:#E1E4E8;">::</span><span style="color:#B392F0;">close</span><span style="color:#E1E4E8;">&gt;;</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#F97583;">private:</span></span>
<span class="line"><span style="color:#E1E4E8;">         </span><span style="color:#F97583;">struct</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">[[</span><span style="color:#B392F0;">eosio</span><span style="color:#79B8FF;">::</span><span style="color:#B392F0;">table</span><span style="color:#79B8FF;">]]</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">account</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">            asset    balance;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">uint64_t</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">primary_key</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> { </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> balance.symbol.</span><span style="color:#B392F0;">code</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">raw</span><span style="color:#E1E4E8;">(); }</span></span>
<span class="line"><span style="color:#E1E4E8;">         };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">         </span><span style="color:#F97583;">struct</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">[[</span><span style="color:#B392F0;">eosio</span><span style="color:#79B8FF;">::</span><span style="color:#B392F0;">table</span><span style="color:#79B8FF;">]]</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">currency_stats</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">            asset    supply;</span></span>
<span class="line"><span style="color:#E1E4E8;">            asset    max_supply;</span></span>
<span class="line"><span style="color:#E1E4E8;">            name     issuer;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">uint64_t</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">primary_key</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> { </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> supply.symbol.</span><span style="color:#B392F0;">code</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">raw</span><span style="color:#E1E4E8;">(); }</span></span>
<span class="line"><span style="color:#E1E4E8;">         };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">         </span><span style="color:#F97583;">typedef</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">eosio</span><span style="color:#E1E4E8;">::multi_index</span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;accounts&quot;</span><span style="color:#F97583;">_n</span><span style="color:#E1E4E8;">, account </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> accounts;</span></span>
<span class="line"><span style="color:#E1E4E8;">         </span><span style="color:#F97583;">typedef</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">eosio</span><span style="color:#E1E4E8;">::multi_index</span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;stat&quot;</span><span style="color:#F97583;">_n</span><span style="color:#E1E4E8;">, currency_stats </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> stats;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">         </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">sub_balance</span><span style="color:#E1E4E8;">( </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">name</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">owner</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">asset</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">value</span><span style="color:#E1E4E8;"> );</span></span>
<span class="line"><span style="color:#E1E4E8;">         </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">add_balance</span><span style="color:#E1E4E8;">( </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">name</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">owner</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">asset</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">value</span><span style="color:#E1E4E8;"> );</span></span>
<span class="line"><span style="color:#E1E4E8;">   };</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">#pragma</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">once</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&lt;eosio/asset.hpp&gt;</span></span>
<span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&lt;eosio/eosio.hpp&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&lt;string&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">namespace</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">eosiosystem</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">system_contract</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">namespace</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">eosio</span><span style="color:#24292E;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#D73A49;">using</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">std</span><span style="color:#24292E;">::string;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">   /**</span></span>
<span class="line"><span style="color:#6A737D;">    * eosio.token contract defines the structures and actions that allow users to create, issue, and manage</span></span>
<span class="line"><span style="color:#6A737D;">    * tokens on EOSIO based blockchains.</span></span>
<span class="line"><span style="color:#6A737D;">    */</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">[[</span><span style="color:#6F42C1;">eosio</span><span style="color:#005CC5;">::</span><span style="color:#6F42C1;">contract</span><span style="color:#005CC5;">(</span><span style="color:#032F62;">&quot;eosio.token&quot;</span><span style="color:#005CC5;">)]]</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">token</span><span style="color:#24292E;"> : </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">contract</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">public:</span></span>
<span class="line"><span style="color:#24292E;">         </span><span style="color:#D73A49;">using</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">contract</span><span style="color:#24292E;">::contract;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">         /**</span></span>
<span class="line"><span style="color:#6A737D;">          * Allows \`issuer\` account to create a token in supply of \`maximum_supply\`. If validation is successful a new entry in statstable for token symbol scope gets created.</span></span>
<span class="line"><span style="color:#6A737D;">          *</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#D73A49;">@param</span><span style="color:#6A737D;"> </span><span style="color:#E36209;">issuer</span><span style="color:#6A737D;"> - the account that creates the token,</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#D73A49;">@param</span><span style="color:#6A737D;"> </span><span style="color:#E36209;">maximum_supply</span><span style="color:#6A737D;"> - the maximum supply set for the token created.</span></span>
<span class="line"><span style="color:#6A737D;">          *</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#D73A49;">@pre</span><span style="color:#6A737D;"> Token symbol has to be valid,</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#D73A49;">@pre</span><span style="color:#6A737D;"> Token symbol must not be already created,</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#D73A49;">@pre</span><span style="color:#6A737D;"> maximum_supply has to be smaller than the maximum supply allowed by the system: 1^62 - 1.</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#D73A49;">@pre</span><span style="color:#6A737D;"> Maximum supply must be positive;</span></span>
<span class="line"><span style="color:#6A737D;">          */</span></span>
<span class="line"><span style="color:#24292E;">         </span><span style="color:#005CC5;">[[</span><span style="color:#6F42C1;">eosio</span><span style="color:#005CC5;">::</span><span style="color:#6F42C1;">action</span><span style="color:#005CC5;">]]</span></span>
<span class="line"><span style="color:#24292E;">         </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">create</span><span style="color:#24292E;">( </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">name</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;">   </span><span style="color:#E36209;">issuer</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                      </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">asset</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;">  </span><span style="color:#E36209;">maximum_supply</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#6A737D;">         /**</span></span>
<span class="line"><span style="color:#6A737D;">          *  This action issues to \`to\` account a \`quantity\` of tokens.</span></span>
<span class="line"><span style="color:#6A737D;">          *</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#D73A49;">@param</span><span style="color:#6A737D;"> </span><span style="color:#E36209;">to</span><span style="color:#6A737D;"> - the account to issue tokens to, it must be the same as the issuer,</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#D73A49;">@param</span><span style="color:#6A737D;"> </span><span style="color:#E36209;">quntity</span><span style="color:#6A737D;"> - the amount of tokens to be issued,</span></span>
<span class="line"><span style="color:#6A737D;">          * @memo - the memo string that accompanies the token issue transaction.</span></span>
<span class="line"><span style="color:#6A737D;">          */</span></span>
<span class="line"><span style="color:#24292E;">         </span><span style="color:#005CC5;">[[</span><span style="color:#6F42C1;">eosio</span><span style="color:#005CC5;">::</span><span style="color:#6F42C1;">action</span><span style="color:#005CC5;">]]</span></span>
<span class="line"><span style="color:#24292E;">         </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">issue</span><span style="color:#24292E;">( </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">name</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">to</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">asset</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">quantity</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">string</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">memo</span><span style="color:#24292E;"> );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">         /**</span></span>
<span class="line"><span style="color:#6A737D;">          * The opposite for create action, if all validations succeed,</span></span>
<span class="line"><span style="color:#6A737D;">          * it debits the statstable.supply amount.</span></span>
<span class="line"><span style="color:#6A737D;">          *</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#D73A49;">@param</span><span style="color:#6A737D;"> </span><span style="color:#E36209;">quantity</span><span style="color:#6A737D;"> - the quantity of tokens to retire,</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#D73A49;">@param</span><span style="color:#6A737D;"> </span><span style="color:#E36209;">memo</span><span style="color:#6A737D;"> - the memo string to accompany the transaction.</span></span>
<span class="line"><span style="color:#6A737D;">          */</span></span>
<span class="line"><span style="color:#24292E;">         </span><span style="color:#005CC5;">[[</span><span style="color:#6F42C1;">eosio</span><span style="color:#005CC5;">::</span><span style="color:#6F42C1;">action</span><span style="color:#005CC5;">]]</span></span>
<span class="line"><span style="color:#24292E;">         </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">retire</span><span style="color:#24292E;">( </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">asset</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">quantity</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">string</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">memo</span><span style="color:#24292E;"> );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">         /**</span></span>
<span class="line"><span style="color:#6A737D;">          * Allows \`from\` account to transfer to \`to\` account the \`quantity\` tokens.</span></span>
<span class="line"><span style="color:#6A737D;">          * One account is debited and the other is credited with quantity tokens.</span></span>
<span class="line"><span style="color:#6A737D;">          *</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#D73A49;">@param</span><span style="color:#6A737D;"> </span><span style="color:#E36209;">from</span><span style="color:#6A737D;"> - the account to transfer from,</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#D73A49;">@param</span><span style="color:#6A737D;"> </span><span style="color:#E36209;">to</span><span style="color:#6A737D;"> - the account to be transferred to,</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#D73A49;">@param</span><span style="color:#6A737D;"> </span><span style="color:#E36209;">quantity</span><span style="color:#6A737D;"> - the quantity of tokens to be transferred,</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#D73A49;">@param</span><span style="color:#6A737D;"> </span><span style="color:#E36209;">memo</span><span style="color:#6A737D;"> - the memo string to accompany the transaction.</span></span>
<span class="line"><span style="color:#6A737D;">          */</span></span>
<span class="line"><span style="color:#24292E;">         </span><span style="color:#005CC5;">[[</span><span style="color:#6F42C1;">eosio</span><span style="color:#005CC5;">::</span><span style="color:#6F42C1;">action</span><span style="color:#005CC5;">]]</span></span>
<span class="line"><span style="color:#24292E;">         </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">transfer</span><span style="color:#24292E;">( </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">name</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;">    </span><span style="color:#E36209;">from</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                        </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">name</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;">    </span><span style="color:#E36209;">to</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                        </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">asset</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;">   </span><span style="color:#E36209;">quantity</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                        </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">string</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;">  </span><span style="color:#E36209;">memo</span><span style="color:#24292E;"> );</span></span>
<span class="line"><span style="color:#6A737D;">         /**</span></span>
<span class="line"><span style="color:#6A737D;">          * Allows \`ram_payer\` to create an account \`owner\` with zero balance for</span></span>
<span class="line"><span style="color:#6A737D;">          * token \`symbol\` at the expense of \`ram_payer\`.</span></span>
<span class="line"><span style="color:#6A737D;">          *</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#D73A49;">@param</span><span style="color:#6A737D;"> </span><span style="color:#E36209;">owner</span><span style="color:#6A737D;"> - the account to be created,</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#D73A49;">@param</span><span style="color:#6A737D;"> </span><span style="color:#E36209;">symbol</span><span style="color:#6A737D;"> - the token to be payed with by \`ram_payer\`,</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#D73A49;">@param</span><span style="color:#6A737D;"> </span><span style="color:#E36209;">ram_payer</span><span style="color:#6A737D;"> - the account that supports the cost of this action.</span></span>
<span class="line"><span style="color:#6A737D;">          *</span></span>
<span class="line"><span style="color:#6A737D;">          * More information can be read [here](https://github.com/EOSIO/eosio.contracts/issues/62)</span></span>
<span class="line"><span style="color:#6A737D;">          * and [here](https://github.com/EOSIO/eosio.contracts/issues/61).</span></span>
<span class="line"><span style="color:#6A737D;">          */</span></span>
<span class="line"><span style="color:#24292E;">         </span><span style="color:#005CC5;">[[</span><span style="color:#6F42C1;">eosio</span><span style="color:#005CC5;">::</span><span style="color:#6F42C1;">action</span><span style="color:#005CC5;">]]</span></span>
<span class="line"><span style="color:#24292E;">         </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">open</span><span style="color:#24292E;">( </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">name</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">owner</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">symbol</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">symbol</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">name</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">ram_payer</span><span style="color:#24292E;"> );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">         /**</span></span>
<span class="line"><span style="color:#6A737D;">          * This action is the opposite for open, it closes the account \`owner\`</span></span>
<span class="line"><span style="color:#6A737D;">          * for token \`symbol\`.</span></span>
<span class="line"><span style="color:#6A737D;">          *</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#D73A49;">@param</span><span style="color:#6A737D;"> </span><span style="color:#E36209;">owner</span><span style="color:#6A737D;"> - the owner account to execute the close action for,</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#D73A49;">@param</span><span style="color:#6A737D;"> </span><span style="color:#E36209;">symbol</span><span style="color:#6A737D;"> - the symbol of the token to execute the close action for.</span></span>
<span class="line"><span style="color:#6A737D;">          *</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#D73A49;">@pre</span><span style="color:#6A737D;"> The pair of owner plus symbol has to exist otherwise no action is executed,</span></span>
<span class="line"><span style="color:#6A737D;">          * </span><span style="color:#D73A49;">@pre</span><span style="color:#6A737D;"> If the pair of owner plus symbol exists, the balance has to be zero.</span></span>
<span class="line"><span style="color:#6A737D;">          */</span></span>
<span class="line"><span style="color:#24292E;">         </span><span style="color:#005CC5;">[[</span><span style="color:#6F42C1;">eosio</span><span style="color:#005CC5;">::</span><span style="color:#6F42C1;">action</span><span style="color:#005CC5;">]]</span></span>
<span class="line"><span style="color:#24292E;">         </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">close</span><span style="color:#24292E;">( </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">name</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">owner</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">symbol</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">symbol</span><span style="color:#24292E;"> );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">         </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">asset</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">get_supply</span><span style="color:#24292E;">( </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">name</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">token_contract_account</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">symbol_code</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">sym_code</span><span style="color:#24292E;"> )</span></span>
<span class="line"><span style="color:#24292E;">         {</span></span>
<span class="line"><span style="color:#24292E;">            stats </span><span style="color:#6F42C1;">statstable</span><span style="color:#24292E;">( token_contract_account, sym_code.</span><span style="color:#6F42C1;">raw</span><span style="color:#24292E;">() );</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">auto&amp;</span><span style="color:#24292E;"> st </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> statstable.</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">( sym_code.</span><span style="color:#6F42C1;">raw</span><span style="color:#24292E;">() );</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> st.supply;</span></span>
<span class="line"><span style="color:#24292E;">         }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">         </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">asset</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">get_balance</span><span style="color:#24292E;">( </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">name</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">token_contract_account</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">name</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">owner</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">symbol_code</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">sym_code</span><span style="color:#24292E;"> )</span></span>
<span class="line"><span style="color:#24292E;">         {</span></span>
<span class="line"><span style="color:#24292E;">            accounts </span><span style="color:#6F42C1;">accountstable</span><span style="color:#24292E;">( token_contract_account, owner.value );</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">auto&amp;</span><span style="color:#24292E;"> ac </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> accountstable.</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">( sym_code.</span><span style="color:#6F42C1;">raw</span><span style="color:#24292E;">() );</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> ac.balance;</span></span>
<span class="line"><span style="color:#24292E;">         }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">         </span><span style="color:#D73A49;">using</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">create_action</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">eosio</span><span style="color:#24292E;">::</span><span style="color:#6F42C1;">action_wrapper</span><span style="color:#24292E;">&lt;</span><span style="color:#032F62;">&quot;create&quot;</span><span style="color:#D73A49;">_n</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">&amp;</span><span style="color:#6F42C1;">token</span><span style="color:#24292E;">::</span><span style="color:#6F42C1;">create</span><span style="color:#24292E;">&gt;;</span></span>
<span class="line"><span style="color:#24292E;">         </span><span style="color:#D73A49;">using</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">issue_action</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">eosio</span><span style="color:#24292E;">::</span><span style="color:#6F42C1;">action_wrapper</span><span style="color:#24292E;">&lt;</span><span style="color:#032F62;">&quot;issue&quot;</span><span style="color:#D73A49;">_n</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">&amp;</span><span style="color:#6F42C1;">token</span><span style="color:#24292E;">::</span><span style="color:#6F42C1;">issue</span><span style="color:#24292E;">&gt;;</span></span>
<span class="line"><span style="color:#24292E;">         </span><span style="color:#D73A49;">using</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">retire_action</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">eosio</span><span style="color:#24292E;">::</span><span style="color:#6F42C1;">action_wrapper</span><span style="color:#24292E;">&lt;</span><span style="color:#032F62;">&quot;retire&quot;</span><span style="color:#D73A49;">_n</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">&amp;</span><span style="color:#6F42C1;">token</span><span style="color:#24292E;">::</span><span style="color:#6F42C1;">retire</span><span style="color:#24292E;">&gt;;</span></span>
<span class="line"><span style="color:#24292E;">         </span><span style="color:#D73A49;">using</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">transfer_action</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">eosio</span><span style="color:#24292E;">::</span><span style="color:#6F42C1;">action_wrapper</span><span style="color:#24292E;">&lt;</span><span style="color:#032F62;">&quot;transfer&quot;</span><span style="color:#D73A49;">_n</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">&amp;</span><span style="color:#6F42C1;">token</span><span style="color:#24292E;">::</span><span style="color:#6F42C1;">transfer</span><span style="color:#24292E;">&gt;;</span></span>
<span class="line"><span style="color:#24292E;">         </span><span style="color:#D73A49;">using</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">open_action</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">eosio</span><span style="color:#24292E;">::</span><span style="color:#6F42C1;">action_wrapper</span><span style="color:#24292E;">&lt;</span><span style="color:#032F62;">&quot;open&quot;</span><span style="color:#D73A49;">_n</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">&amp;</span><span style="color:#6F42C1;">token</span><span style="color:#24292E;">::</span><span style="color:#6F42C1;">open</span><span style="color:#24292E;">&gt;;</span></span>
<span class="line"><span style="color:#24292E;">         </span><span style="color:#D73A49;">using</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">close_action</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">eosio</span><span style="color:#24292E;">::</span><span style="color:#6F42C1;">action_wrapper</span><span style="color:#24292E;">&lt;</span><span style="color:#032F62;">&quot;close&quot;</span><span style="color:#D73A49;">_n</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">&amp;</span><span style="color:#6F42C1;">token</span><span style="color:#24292E;">::</span><span style="color:#6F42C1;">close</span><span style="color:#24292E;">&gt;;</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">private:</span></span>
<span class="line"><span style="color:#24292E;">         </span><span style="color:#D73A49;">struct</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">[[</span><span style="color:#6F42C1;">eosio</span><span style="color:#005CC5;">::</span><span style="color:#6F42C1;">table</span><span style="color:#005CC5;">]]</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">account</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">            asset    balance;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">uint64_t</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">primary_key</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> { </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> balance.symbol.</span><span style="color:#6F42C1;">code</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">raw</span><span style="color:#24292E;">(); }</span></span>
<span class="line"><span style="color:#24292E;">         };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">         </span><span style="color:#D73A49;">struct</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">[[</span><span style="color:#6F42C1;">eosio</span><span style="color:#005CC5;">::</span><span style="color:#6F42C1;">table</span><span style="color:#005CC5;">]]</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">currency_stats</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">            asset    supply;</span></span>
<span class="line"><span style="color:#24292E;">            asset    max_supply;</span></span>
<span class="line"><span style="color:#24292E;">            name     issuer;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">uint64_t</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">primary_key</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> { </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> supply.symbol.</span><span style="color:#6F42C1;">code</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">raw</span><span style="color:#24292E;">(); }</span></span>
<span class="line"><span style="color:#24292E;">         };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">         </span><span style="color:#D73A49;">typedef</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">eosio</span><span style="color:#24292E;">::multi_index</span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;accounts&quot;</span><span style="color:#D73A49;">_n</span><span style="color:#24292E;">, account </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> accounts;</span></span>
<span class="line"><span style="color:#24292E;">         </span><span style="color:#D73A49;">typedef</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">eosio</span><span style="color:#24292E;">::multi_index</span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;stat&quot;</span><span style="color:#D73A49;">_n</span><span style="color:#24292E;">, currency_stats </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> stats;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">         </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">sub_balance</span><span style="color:#24292E;">( </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">name</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">owner</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">asset</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">value</span><span style="color:#24292E;"> );</span></span>
<span class="line"><span style="color:#24292E;">         </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">add_balance</span><span style="color:#24292E;">( </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">name</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">owner</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">asset</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">value</span><span style="color:#24292E;"> );</span></span>
<span class="line"><span style="color:#24292E;">   };</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h2 id="cmakelists-txt" tabindex="-1">CMakeLists.txt <a class="header-anchor" href="#cmakelists-txt" aria-label="Permalink to &quot;CMakeLists.txt&quot;">​</a></h2><div class="language-cmake vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cmake</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">cmake_minimum_required</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">VERSION</span><span style="color:#E1E4E8;"> 3.5)</span></span>
<span class="line"><span style="color:#F97583;">project</span><span style="color:#E1E4E8;">(eosio.token)</span></span>
<span class="line"><span style="color:#F97583;">set</span><span style="color:#E1E4E8;">(EOSIO_WASM_OLD_BEHAVIOR </span><span style="color:#9ECBFF;">&quot;Off&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#F97583;">find_package</span><span style="color:#E1E4E8;">(eosio.cdt)</span></span>
<span class="line"><span style="color:#F97583;">include</span><span style="color:#E1E4E8;">(EosioWasmToolchain)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">add_contract(eosio.token eosio.token </span><span style="color:#F97583;">\${CMAKE_CURRENT_SOURCE_DIR}</span><span style="color:#E1E4E8;">/src/eosio.token.cpp)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">target_include_directories</span><span style="color:#E1E4E8;">(eosio.token</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">PUBLIC</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#F97583;">\${CMAKE_CURRENT_SOURCE_DIR}</span><span style="color:#E1E4E8;">/include)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">set_target_properties</span><span style="color:#E1E4E8;">(eosio.token</span></span>
<span class="line"><span style="color:#E1E4E8;">   PROPERTIES</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#FFAB70;">RUNTIME_OUTPUT_DIRECTORY</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;\${CMAKE_CURRENT_BINARY_DIR}&quot;</span><span style="color:#E1E4E8;">)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">cmake_minimum_required</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">VERSION</span><span style="color:#24292E;"> 3.5)</span></span>
<span class="line"><span style="color:#D73A49;">project</span><span style="color:#24292E;">(eosio.token)</span></span>
<span class="line"><span style="color:#D73A49;">set</span><span style="color:#24292E;">(EOSIO_WASM_OLD_BEHAVIOR </span><span style="color:#032F62;">&quot;Off&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#D73A49;">find_package</span><span style="color:#24292E;">(eosio.cdt)</span></span>
<span class="line"><span style="color:#D73A49;">include</span><span style="color:#24292E;">(EosioWasmToolchain)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">add_contract(eosio.token eosio.token </span><span style="color:#D73A49;">\${CMAKE_CURRENT_SOURCE_DIR}</span><span style="color:#24292E;">/src/eosio.token.cpp)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">target_include_directories</span><span style="color:#24292E;">(eosio.token</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">PUBLIC</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#D73A49;">\${CMAKE_CURRENT_SOURCE_DIR}</span><span style="color:#24292E;">/include)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">set_target_properties</span><span style="color:#24292E;">(eosio.token</span></span>
<span class="line"><span style="color:#24292E;">   PROPERTIES</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#E36209;">RUNTIME_OUTPUT_DIRECTORY</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;\${CMAKE_CURRENT_BINARY_DIR}&quot;</span><span style="color:#24292E;">)</span></span></code></pre></div>`,7),e=[o];function t(c,r,y,E,i,F){return a(),n("div",null,e)}const A=s(l,[["render",t]]);export{m as __pageData,A as default};
