import{_ as s,c as a,o as n,V as o}from"./chunks/framework.281622bf.js";const d=JSON.parse('{"title":"Updating Metadata","description":"","frontmatter":{"title":"Updating Metadata","deploy":["staging","mainnet"],"order":-99992},"headers":[],"relativePath":"guides/Uniq Variants/updating-metadata.md","lastUpdated":1689251539000}'),t={name:"guides/Uniq Variants/updating-metadata.md"},l=o(`<h1 id="updating-uniqs" tabindex="-1">Updating uniqs <a class="header-anchor" href="#updating-uniqs" aria-label="Permalink to &quot;Updating uniqs&quot;">​</a></h1><p>An important aspect of the Ultra NFT standard is metadata updates. Game publishers should be able to change uniq&#39;s traits based on certain events in their games. On the other hand integrators should be able to verify its authenticity. Let&#39;s see how it works with the examples below:</p><h2 id="creating-a-factory-issuing-tokens" tabindex="-1">Creating a factory &amp; Issuing tokens <a class="header-anchor" href="#creating-a-factory-issuing-tokens" aria-label="Permalink to &quot;Creating a factory &amp; Issuing tokens&quot;">​</a></h2><p>Let&#39;s <a href="/experimental/docs/contracts/NFT Contract/NFT Actions/create.b.html"><code>create</code></a> a factory first and <a href="/experimental/docs/contracts/NFT Contract/NFT Actions/issue.b.html"><code>issue</code></a> a token:</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># Create</span></span>
<span class="line"><span style="color:#FFCB6B;">cleos</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">push</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">action</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">eosio.nft.ft</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">create.b</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[</span></span>
<span class="line"><span style="color:#C3E88D;">  {</span></span>
<span class="line"><span style="color:#C3E88D;">    &quot;memo&quot;: &quot;&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">    &quot;asset_manager&quot;: &quot;ultra.nft.ft&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">    &quot;asset_creator&quot;: &quot;ultra&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">    &quot;minimum_resell_price&quot;: null,</span></span>
<span class="line"><span style="color:#C3E88D;">    &quot;resale_shares&quot;: [</span></span>
<span class="line"><span style="color:#C3E88D;">      {</span></span>
<span class="line"><span style="color:#C3E88D;">        &quot;receiver&quot;: &quot;ultra.nft.ft&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">        &quot;basis_point&quot;: 1</span></span>
<span class="line"><span style="color:#C3E88D;">      }</span></span>
<span class="line"><span style="color:#C3E88D;">    ],</span></span>
<span class="line"><span style="color:#C3E88D;">    &quot;mintable_window_start&quot;: &quot;2021-05-31T00:00:00&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">    &quot;mintable_window_end&quot;: null,</span></span>
<span class="line"><span style="color:#C3E88D;">    &quot;trading_window_start&quot;: &quot;2021-05-31T00:00:00&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">    &quot;trading_window_end&quot;: null,</span></span>
<span class="line"><span style="color:#C3E88D;">    &quot;recall_window_start&quot;: null,</span></span>
<span class="line"><span style="color:#C3E88D;">    &quot;recall_window_end&quot;: null,</span></span>
<span class="line"><span style="color:#C3E88D;">    &quot;max_mintable_tokens&quot;: 10000,</span></span>
<span class="line"><span style="color:#C3E88D;">    &quot;lockup_time&quot;: null,</span></span>
<span class="line"><span style="color:#C3E88D;">    &quot;conditionless_receivers&quot;: null,</span></span>
<span class="line"><span style="color:#C3E88D;">    &quot;stat&quot;: 0,</span></span>
<span class="line"><span style="color:#C3E88D;">    &quot;factory_uri&quot;: &quot;ipfs://my_factory_uri&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">    &quot;factory_hash&quot;: &quot;475970a4b0016368d0503d1ce01577376f91f5a5ba63dd4353683bd95101b88d&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">    &quot;authorized_minters&quot;: null,</span></span>
<span class="line"><span style="color:#C3E88D;">    &quot;account_minting_limit&quot;: 100,</span></span>
<span class="line"><span style="color:#C3E88D;">    &quot;transfer_window_start&quot;: null,</span></span>
<span class="line"><span style="color:#C3E88D;">    &quot;transfer_window_end&quot;: null,</span></span>
<span class="line"><span style="color:#C3E88D;">    &quot;maximum_uos_payment&quot;: null,</span></span>
<span class="line"><span style="color:#C3E88D;">    &quot;default_token_uri&quot;: &quot;ipfs://my_default_token&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">    &quot;default_token_hash&quot;: &quot;475970a4b0016368d0503d1ce01577376f91f5a5ba63dd4353683bd95101b88d&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">    &quot;lock_hash&quot;: null</span></span>
<span class="line"><span style="color:#C3E88D;">  }</span></span>
<span class="line"><span style="color:#C3E88D;">]</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-p</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ultra.nft.ft</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-p</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ultra</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Issue</span></span>
<span class="line"><span style="color:#FFCB6B;">cleos</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">push</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">action</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">eosio.nft.ft</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">issue.b</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[</span></span>
<span class="line"><span style="color:#C3E88D;">  {</span></span>
<span class="line"><span style="color:#C3E88D;">    &quot;to&quot;: &quot;ultra&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">    &quot;token_configs&quot;: [</span></span>
<span class="line"><span style="color:#C3E88D;">      {</span></span>
<span class="line"><span style="color:#C3E88D;">        &quot;token_factory_id&quot;: 0,</span></span>
<span class="line"><span style="color:#C3E88D;">        &quot;amount&quot;: 1,</span></span>
<span class="line"><span style="color:#C3E88D;">        &quot;custom_data&quot;: &quot;&quot;</span></span>
<span class="line"><span style="color:#C3E88D;">      }</span></span>
<span class="line"><span style="color:#C3E88D;">    ],</span></span>
<span class="line"><span style="color:#C3E88D;">    &quot;memo&quot;: &quot;&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">    &quot;authorizer&quot;: null,</span></span>
<span class="line"><span style="color:#C3E88D;">    &quot;maximum_uos_payment&quot;: null,</span></span>
<span class="line"><span style="color:#C3E88D;">    &quot;token_metadata&quot;: [</span></span>
<span class="line"><span style="color:#C3E88D;">      {</span></span>
<span class="line"><span style="color:#C3E88D;">        &quot;meta_uri&quot;: &quot;ipfs://uniq_uri&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">        &quot;meta_hash&quot;:&quot;475970a4b0016368d0503d1ce01577376f91f5a5ba63dd4353683bd95101b88d&quot;</span></span>
<span class="line"><span style="color:#C3E88D;">      }</span></span>
<span class="line"><span style="color:#C3E88D;">    ]</span></span>
<span class="line"><span style="color:#C3E88D;">  }</span></span>
<span class="line"><span style="color:#C3E88D;">]</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-p</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ultra.nft.ft</span></span></code></pre></div><p>After a factory and token is minted we can look up their ids from <code>factory.b</code> and <code>token.b</code> tables respectively. Let&#39;s say they&#39;re both <code>0</code> for the sake of this tutorial.</p><h2 id="updating-factory-metadata" tabindex="-1">Updating factory metadata <a class="header-anchor" href="#updating-factory-metadata" aria-label="Permalink to &quot;Updating factory metadata&quot;">​</a></h2><p>If a content creator reuploads a new factory metadata they have to use <a href="/experimental/docs/contract-nft/nft-actions/091_setmeta.b.html"><code>setmeta.b</code></a> to change the corresponding data:</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">cleos</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">push</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">action</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">eosio.nft.ft</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">setmeta.b</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[</span></span>
<span class="line"><span style="color:#C3E88D;">  0,</span></span>
<span class="line"><span style="color:#C3E88D;">  &quot;updating&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">  &quot;ipfs://new_factory_uri&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">  &quot;06528450506980cf5ab3a5cfeb870cb3109acd2fe6094c00d4e4ab31ac129b35&quot;</span></span>
<span class="line"><span style="color:#C3E88D;">]</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-p</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ultra.nft.ft</span></span></code></pre></div><h2 id="updating-a-default-token" tabindex="-1">Updating a default token <a class="header-anchor" href="#updating-a-default-token" aria-label="Permalink to &quot;Updating a default token&quot;">​</a></h2><p>Default token metadata is used as a fallback mechanism whenever there&#39;s no uri for a token. Here&#39;s how one updates on-chain data for it using <a href="./../../contracts/NFT Contract/NFT Actions/setdflttkn.html">setdflttkn</a> action:</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">cleos</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">push</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">action</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">eosio.nft.ft</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">setdflttkn</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[</span></span>
<span class="line"><span style="color:#C3E88D;">  0,</span></span>
<span class="line"><span style="color:#C3E88D;">  &quot;reuploading default token&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">  &quot;https://s3...&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">  &quot;fbbf2217571b6dbe2fca75b0fd3aebb5b4e247bc89e235d4d09d014bb855d1c9&quot;</span></span>
<span class="line"><span style="color:#C3E88D;">]</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-p</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ultra.nft.ft</span></span></code></pre></div><h2 id="update-a-uniq" tabindex="-1">Update a uniq <a class="header-anchor" href="#update-a-uniq" aria-label="Permalink to &quot;Update a uniq&quot;">​</a></h2><p>Updating uniq&#39;s is done with <a href="./../../contracts/NFT Contract/NFT Actions/settknmeta.html"><code>settknmeta</code></a> action:</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">cleos</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">push</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">action</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">eosio.nft.ft</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">settknmeta</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[</span></span>
<span class="line"><span style="color:#C3E88D;">  0,</span></span>
<span class="line"><span style="color:#C3E88D;">  &quot;ultra&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">  &quot;update hash 2&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">  &quot;ipfs://uniq_uri&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">  &quot;cccf7bb05104ee6737d94a7f85b3cf4a9f44f67f2d198572c155721a07395613&quot;</span></span>
<span class="line"><span style="color:#C3E88D;">]</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-p</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ultra.nft.ft@active</span></span></code></pre></div><p>It&#39;s important to reiterate that whenever you make any changes to metadata (including images updates) for a token/factory you should also update corresponding data onchain, i.e uris/hashes. Otherwise, integrators won&#39;t be able to pick up the changes.</p><h2 id="locking-changes" tabindex="-1">Locking changes <a class="header-anchor" href="#locking-changes" aria-label="Permalink to &quot;Locking changes&quot;">​</a></h2><p>For certain usecases it might make sense to make a factory immutable. Luckily there&#39;s a <a href="./../../contracts/NFT Contract/NFT Actions/lckfactory.html"><code>lckfactory</code></a> action which enables a manager to disable any content updates. This might be useful for an nft art gallery as it allows the users to be sure theirupdating_metadata.md artwork will never change.</p><p><strong>THE CHANGE IS IRREVERSIBLE:</strong></p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">cleos</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">push</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">action</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">eosio.nft.ft</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">lckfactory</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[0]</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-p</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ultra.nft.ft@active</span></span></code></pre></div><p>Updating a token hash of factory <code>0</code> afterwards will fail:</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">cleos</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">push</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">action</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">eosio.nft.ft</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">settknmeta</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[</span></span>
<span class="line"><span style="color:#C3E88D;">  0,</span></span>
<span class="line"><span style="color:#C3E88D;">  &quot;ultra&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">  &quot;update hash 2&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">  &quot;ipfs://&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">  &quot;cccf7bb05104ee6737d94a7f85b3cf4a9f44f67f2d198572c155721a07395613&quot;</span></span>
<span class="line"><span style="color:#C3E88D;">]</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-p</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ultra.nft.ft@active</span></span>
<span class="line"><span style="color:#FFCB6B;">Error</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10500149</span><span style="color:#C3E88D;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">token</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">hash</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">must</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">be</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">same</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">value</span></span>
<span class="line"><span style="color:#FFCB6B;">Error</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Details:</span></span>
<span class="line"><span style="color:#FFCB6B;">assertion</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">failure</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">with</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">message:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">token</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">hash</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">must</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">be</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">same</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">value</span></span></code></pre></div>`,22),p=[l];function e(c,r,i,C,u,y){return n(),a("div",null,p)}const q=s(t,[["render",e]]);export{d as __pageData,q as default};
